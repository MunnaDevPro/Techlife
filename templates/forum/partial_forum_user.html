 {% load static %}


<section class="min-h-screen -mt-6 py-10 px-4 rounded-2xl">

    <div class="mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-3">

            <!-- Card 1 -->
            {% for user in all_users %} {% if user.email and user.first_name %}
            <div class="border border-gray-200 bg-white hover:border-gray-300 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300">
                <div class="p-5 text-center">
                    <img src="{{ user.profile_picture.url }}" alt="{{ user.first_name }}" class="w-24 h-24 rounded-full mx-auto mb-3 border-2 border-blue-500 object-cover">
                    <div>
                        <span class="text-base font-semibold text-gray-900 line-clamp-1">{{ user.first_name }} {{ user.last_name }} </span>
                    </div>
                    <p class="text-sm text-gray-600 mt-1 min-h-[36px] line-clamp-1">{{ user.email }}</p>
                </div>

                <div class="px-5 pb-6">
                    <div class="flex justify-between py-3 border-t-[1px]">
                        <div class="text-center flex-1">
                            <div class="text-xs font-semibold text-gray-600 mb-1">Posts</div>
                            <div class="text-[16px] font-semibold text-blue-600">{{ user.authored_posts.count }}</div>
                        </div>
                        <div class="text-center flex-1">
                            <div class="text-xs font-semibold text-gray-600 mb-1">Question</div>
                            <div class="text-[16px] font-semibold text-blue-700">{{ user.questions.count }}</div>
                        </div>
                    </div>

                    <div class="flex flex-col gap-2 mt-2">
                        <form hx-post="{% url 'toggle_follow' user.pk %}" hx-target="#blog_post_form" hx-swap="innerHTML" class="w-full">
                            {% csrf_token %} {% if user in request.user.follow_section.following.all %}
                            <button type="submit" class="w-full text-[14px] py-1.5 px-4 bg-gray-100 text-gray-800 border border-gray-300 rounded-full font-semibold hover:bg-gray-200 transition-colors duration-200">
            Following
        </button> {% else %}
                            <button type="submit" class="w-full text-[14px] py-1.5 px-4 bg-blue-600 text-white rounded-full font-semibold hover:bg-blue-700 transition-colors duration-200">
            Follow
        </button> {% endif %}
                        </form>

                        <a hx-get="{% url 'forum_user_profile_details' user.pk %}" hx-target="#blog_post_form" hx-swap="innerHTML" hx-push-url="true" class="w-full text-center text-[14px] py-1.5 px-4 border border-blue-700 text-blue-700 rounded-full font-semibold hover:bg-blue-50 transition-colors duration-200 cursor-pointer">
                    View Profile
                </a>
                    </div>
                </div>
            </div>
            {% endif %} {% endfor %}


        </div>

        <!-- paginator-->
        {% if all_users %}
        <div class="mt-16 mb-10 flex justify-center">
            <nav class="flex items-center gap-1 p-1 bg-white/80 backdrop-blur-md border border-gray-200/60 rounded-2xl shadow-sm ring-1 ring-black/5" aria-label="Pagination">

                {% if all_users.has_previous %}
                <a href="?page={{ all_users.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200" title="Previous">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M15 19l-7-7 7-7"/></svg>
                </a> {% else %}
                <span class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-200 cursor-not-allowed">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M15 19l-7-7 7-7"/></svg>
        </span> {% endif %}

                <div class="flex items-center px-4 h-10 bg-gray-50/50 rounded-xl border border-gray-100 mx-1">
                    <span class="text-xs font-bold uppercase tracking-widest text-gray-400 mr-2">Page</span>
                    <span class="text-sm font-semibold text-blue-600">{{ all_users.number }}</span>
                    <span class="text-sm font-medium text-gray-300 mx-2">of</span>
                    <span class="text-sm font-semibold text-gray-600">{{ all_users.paginator.num_pages }}</span>
                </div>

                {% if all_users.has_next %}
                <a href="?page={{ all_users.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-500 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200" title="Next">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M9 5l7 7-7 7"/></svg>
                </a>
                {% else %}
                <span class="flex items-center justify-center w-10 h-10 rounded-xl text-gray-200 cursor-not-allowed">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M9 5l7 7-7 7"/></svg>
        </span> {% endif %}

            </nav>
        </div>
        {% endif %}
    </div>
</section>